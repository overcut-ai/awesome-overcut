# GitHub Actions Workflow: Secret Scanning with truffleHog
# -------------------------------------------------------
# Scans every push & pull request diff for leaked secrets.
# Fails the workflow if any issues are found.

name: "Secret Scan"

on:
  push:
    branches: ["**"]
  pull_request:
    branches: ["**"]

jobs:
  trufflehog:
    name: Scan for Secrets
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0  # full history so trufflehog can scan baseline

      - name: Run truffleHog GitHub Action
        uses: trufflesecurity/trufflehog@v3
        with:
          scan: git diff
          # Fail if any finding is detected
          # The action exits with non-zero when secrets are discovered
          # Additional config can be passed as needed (e.g., --regex, --entropy-score)
